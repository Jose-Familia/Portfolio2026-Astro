---
/**
 * BlogPostCard.astro
 * Tarjeta para artículos del blog
 */

import Badge from '@/components/ui/Badge.astro';
import Icon from '@/components/ui/Icon.astro';
import { formatDate } from '@/utils/formatDate';

export interface Props {
  title: string;
  excerpt: string;
  slug: string;
  publishDate: Date;
  coverImage?: string;
  category: string;
  readingTime?: number;
  featured?: boolean;
  index?: number;
}

const {
  title,
  excerpt,
  slug,
  publishDate,
  coverImage,
  category,
  readingTime,
  featured = false,
  index = 0,
} = Astro.props;

const postUrl = `/blog/${slug}`;

const categoryLabels: Record<string, string> = {
  'development': 'Desarrollo',
  'design': 'Diseño',
  'tutorials': 'Tutoriales',
  'opinion': 'Opinión',
  'career': 'Carrera',
};
---

<article
  class:list={[
    'group card-hover flex flex-col animate-fade-in-up',
    featured ? 'md:flex-row' : '',
  ]}
  style={`--stagger: ${index}`}
>
  <!-- Imagen de portada -->
  {coverImage && (
    <a
      href={postUrl}
      class:list={[
        'block overflow-hidden',
        featured ? 'md:w-2/5' : '',
      ]}
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="relative aspect-blog overflow-hidden">
        <img
          src={coverImage}
          alt=""
          class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
          loading="lazy"
          transition:name={`blog-image-${slug}`}
        />
      </div>
    </a>
  )}
  
  <!-- Contenido -->
  <div class:list={[
    'flex flex-col flex-1 p-6',
    featured ? 'md:w-3/5 md:p-8 md:justify-center' : '',
  ]}>
    <!-- Meta info -->
    <div class="flex flex-wrap items-center gap-3 text-sm text-neutral-500 mb-3">
      <Badge variant="primary" size="sm">
        {categoryLabels[category] || category}
      </Badge>
      <span class="flex items-center gap-1.5">
        <Icon name="calendar" size={14} />
        <time datetime={publishDate.toISOString()}>
          {formatDate(publishDate)}
        </time>
      </span>
      {readingTime && (
        <span class="flex items-center gap-1.5">
          <Icon name="clock" size={14} />
          <span>{readingTime} min</span>
        </span>
      )}
    </div>
    
    <!-- Título -->
    <h3 class:list={[
      'font-semibold tracking-tight mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors',
      featured ? 'text-2xl' : 'text-xl',
    ]}>
      <a href={postUrl} class="after:absolute after:inset-0 relative">
        {title}
      </a>
    </h3>
    
    <!-- Extracto -->
    <p class:list={[
      'text-neutral-600 dark:text-neutral-400',
      featured ? 'text-base' : 'text-sm line-clamp-2',
    ]}>
      {excerpt}
    </p>
    
    <!-- Link de lectura -->
    <div class="mt-4">
      <span class="inline-flex items-center gap-1.5 text-sm font-medium text-primary-600 dark:text-primary-400 group-hover:gap-2.5 transition-all">
        Leer artículo
        <Icon name="arrow-right" size={16} />
      </span>
    </div>
  </div>
</article>

<style>
  @media (prefers-reduced-motion: reduce) {
    article {
      opacity: 1;
      animation: none;
    }
  }
</style>
