---
/**
 * About Me Page - José Familia (English version)
 * Professional profile, skills, experience, education and certifications
 */

import BaseLayout from '@/layouts/BaseLayout.astro';
import Icon from '@/components/ui/Icon.astro';
import Badge from '@/components/ui/Badge.astro';
import TechTag from '@/components/ui/TechTag.astro';
import Button from '@/components/ui/Button.astro';
import { t, type Lang } from '@/i18n';
import { aboutContent } from '@/i18n/about';

// Current language
const lang: Lang = 'en';
const content = aboutContent[lang];

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short' });
}

function formatYear(date: Date): string {
  return date.getFullYear().toString();
}
---

<BaseLayout title={t(lang, 'about.title')} description={content.philosophy.description} lang="en">
  <section class="section-sm">
    <div class="container-main">
      <!-- Header with personal philosophy -->
      <header class="max-w-3xl mb-16">
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight mb-4 animate-fade-in-up">
          {t(lang, 'about.title')}
        </h1>
        
        <!-- Personal philosophy -->
        <blockquote class="border-l-4 border-primary-500 pl-6 my-8 animate-fade-in-up" style="--stagger: 1">
          <p class="text-2xl font-semibold text-neutral-800 dark:text-neutral-200 mb-2">
            {content.philosophy.title}
          </p>
          <p class="text-lg text-neutral-600 dark:text-neutral-400 italic">
            {content.philosophy.description}
          </p>
        </blockquote>
      </header>
      
      <div class="grid lg:grid-cols-[2fr_1fr] gap-12 lg:gap-16">
        <!-- Main content -->
        <div class="space-y-16">
          <!-- Bio -->
          <section>
            <h2 class="text-2xl font-semibold mb-6">{t(lang, 'about.myStory')}</h2>
            <div class="prose-custom space-y-4">
              {content.bio.map((paragraph) => (
                <p class="text-neutral-700 dark:text-neutral-300 leading-relaxed">{paragraph}</p>
              ))}
            </div>
          </section>
          
          <!-- Skills -->
          <section>
            <h2 class="text-2xl font-semibold mb-6">{t(lang, 'about.skills')}</h2>
            <div class="space-y-8">
              {content.skills.map((category) => (
                <div>
                  <h3 class="text-lg font-medium text-neutral-700 dark:text-neutral-300 mb-4">
                    {category.category}
                  </h3>
                  <div class="flex flex-wrap gap-2">
                    {category.items.map((skill) => (
                      <TechTag name={skill.name} icon={skill.name} size="md" />
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </section>
          
          <!-- Experience (only show if data exists) -->
          {content.experience.length > 0 && (
            <section>
              <h2 class="text-2xl font-semibold mb-6">{t(lang, 'about.experience')}</h2>
              <div class="space-y-8">
                {content.experience.map((exp) => (
                  <div class="relative pl-8 pb-8 border-l-2 border-neutral-200 dark:border-neutral-800 last:pb-0">
                    <div class="absolute left-0 top-0 w-4 h-4 -translate-x-1/2 rounded-full bg-primary-500"></div>
                    
                    <div class="flex flex-wrap items-center gap-2 mb-2">
                      <h3 class="text-lg font-semibold">{exp.position}</h3>
                      {exp.current && (
                        <Badge variant="success" size="sm">{t(lang, 'about.current')}</Badge>
                      )}
                    </div>
                    
                    <p class="text-primary-600 dark:text-primary-400 font-medium mb-1">
                      {exp.company}
                    </p>
                    
                    <p class="text-sm text-neutral-500 mb-3">
                      {formatDate(exp.startDate)} — {exp.current ? t(lang, 'about.present') : formatDate((exp as any).endDate)}
                      {exp.location && ` · ${exp.location}`}
                    </p>
                    
                    <p class="text-neutral-600 dark:text-neutral-400 mb-3">
                      {exp.description}
                    </p>
                    
                    {exp.highlights && exp.highlights.length > 0 && (
                      <ul class="list-disc list-inside text-sm text-neutral-600 dark:text-neutral-400 space-y-1">
                        {exp.highlights.map((highlight: string) => (
                          <li>{highlight}</li>
                        ))}
                      </ul>
                    )}
                  </div>
                ))}
              </div>
            </section>
          )}
          
          <!-- Education -->
          <section>
            <h2 class="text-2xl font-semibold mb-6">{t(lang, 'about.education')}</h2>
            <div class="space-y-8">
              {content.education.map((edu) => (
                <div class="relative pl-8 pb-8 border-l-2 border-neutral-200 dark:border-neutral-800 last:pb-0">
                  <div class="absolute left-0 top-0 w-4 h-4 -translate-x-1/2 rounded-full bg-primary-500"></div>
                  
                  <div class="flex flex-wrap items-center gap-2 mb-2">
                    <h3 class="text-lg font-semibold">{edu.degree}</h3>
                    {edu.current && (
                      <Badge variant="success" size="sm">{t(lang, 'about.current')}</Badge>
                    )}
                  </div>
                  
                  <p class="text-primary-600 dark:text-primary-400 font-medium mb-1">
                    {edu.institution}
                  </p>
                  
                  <p class="text-sm text-neutral-500 mb-3">
                    {formatYear(edu.startDate)} — {edu.current ? t(lang, 'about.present') : formatYear((edu as any).endDate)}
                    {edu.location && ` · ${edu.location}`}
                  </p>
                  
                  <p class="text-neutral-600 dark:text-neutral-400">
                    {edu.description}
                  </p>
                </div>
              ))}
            </div>
          </section>
          
          <!-- Certifications -->
          <section>
            <h2 class="text-2xl font-semibold mb-6">{t(lang, 'about.certifications')}</h2>
            <div class="grid sm:grid-cols-2 gap-4">
              {content.certifications.map((cert) => (
                <div class="group p-5 rounded-xl bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 hover:border-neutral-300 dark:hover:border-neutral-700 transition-all">
                  <div class="flex items-start justify-between gap-3 mb-3">
                    <div>
                      <h3 class="font-semibold text-neutral-900 dark:text-white mb-1">{cert.name}</h3>
                      <p class="text-sm text-neutral-600 dark:text-neutral-400">
                        {cert.issuer}
                      </p>
                    </div>
                    <span class="text-xs text-neutral-500 whitespace-nowrap">
                      {formatDate(cert.date)}
                    </span>
                  </div>
                  <div class="flex flex-wrap gap-1.5">
                    {cert.skills.map((skill) => (
                      <span class="text-xs px-2 py-1 rounded bg-neutral-200 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400">
                        {skill}
                      </span>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </section>
        </div>
        
        <!-- Sidebar -->
        <aside class="space-y-8">
          <!-- Profile photo -->
          <div class="card p-6">
            <div class="aspect-square rounded-xl overflow-hidden mb-4 bg-gradient-to-br from-primary-100 to-primary-200 dark:from-primary-900 dark:to-primary-800">
              <img
                src="/images/jose-familia.jpg"
                alt={content.name}
                class="w-full h-full object-cover"
                loading="lazy"
                onerror="this.style.display='none'"
              />
            </div>
            <h3 class="font-semibold text-lg mb-1">{content.name}</h3>
            <p class="text-neutral-600 dark:text-neutral-400 text-sm mb-1">
              {content.title}
            </p>
            <p class="text-neutral-500 text-xs mb-4 flex items-center gap-1">
              <Icon name="location" size={14} />
              {content.location}
            </p>
            <div class="flex gap-2">
              <Button href="https://github.com/Jose-Familia" variant="ghost" size="sm" external>
                <Icon name="github" size={18} />
              </Button>
              <Button href="https://www.linkedin.com/in/jrfamilia/" variant="ghost" size="sm" external>
                <Icon name="linkedin" size={18} />
              </Button>
            </div>
          </div>
          
          <!-- Tech stack -->
          <div class="card p-6">
            <h3 class="text-sm font-semibold text-neutral-500 uppercase tracking-wide mb-4">
              {t(lang, 'about.mainStack')}
            </h3>
            <div class="flex flex-wrap gap-2">
              {content.stack.map((tech) => (
                <TechTag name={tech.name} icon={tech.icon} url={tech.url} size="md" />
              ))}
            </div>
          </div>
          
          <!-- CTA Contact -->
          <div class="card p-6 bg-primary-50 dark:bg-primary-950/50 border-primary-100 dark:border-primary-900">
            <h3 class="font-semibold mb-2">{t(lang, 'about.workTogether')}</h3>
            <p class="text-sm text-neutral-600 dark:text-neutral-400 mb-4">
              {t(lang, 'about.available')}
            </p>
            <Button href="/en/contact" variant="primary" class="w-full">
              {t(lang, 'about.contact')}
            </Button>
          </div>
          
          <!-- Language selector -->
          <div class="card p-4">
            <p class="text-xs text-neutral-500 mb-2">Language / Idioma</p>
            <div class="flex gap-2">
              <a 
                href="/sobre-mi" 
                class="px-3 py-1.5 text-sm font-medium rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors"
              >
                ES
              </a>
              <span class="px-3 py-1.5 text-sm font-medium rounded-lg bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300">
                EN
              </span>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </section>
</BaseLayout>
